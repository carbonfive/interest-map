<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>Interest Map</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.10.1/lodash.js"></script>
    <script src="colorbrewer.min.js"></script>
    <style>
      svg { font-size: 14px; }

      .bubble { fill: #800; }

      .axis { font: 10px sans-serif; }

      .axis line,
      .axis path {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
      }

      #bubbles {
        width: 960px;
        margin: 0 auto;
      }
    </style>
    <script>
      var NEW_SKILLS = [
        {"name": "Java 8",                                 "skilled": 3, "interested": 3}
      , {"name": "App Deployment",                         "skilled": 8, "interested": 3}
      , {"name": "Sales",                                  "skilled": 6, "interested": 2}
      , {"name": "Agile Process",                          "skilled":13, "interested": 0}
      , {"name": "Public Speaking",                        "skilled":10, "interested":10}
      , {"name": "Brainstorming",                          "skilled": 7, "interested": 1}
      , {"name": "Information Architecture",               "skilled": 6, "interested": 1}
      , {"name": "Javascript",                             "skilled":14, "interested": 3}
      , {"name": "Copywriting",                            "skilled": 0, "interested": 3}
      , {"name": "Visual Design",                          "skilled": 0, "interested": 2}
      , {"name": "HTML + CSS",                             "skilled":12, "interested": 6}
      , {"name": "Interaction Design",                     "skilled": 5, "interested": 5}
      , {"name": "Client / Project Management",            "skilled":10, "interested": 6}
      , {"name": "NoSQL Databases",                        "skilled": 4, "interested": 4}
      , {"name": "Prototyping",                            "skilled": 9, "interested": 4}
      , {"name": "IT",                                     "skilled": 4, "interested": 3}
      , {"name": "Objective C",                            "skilled": 6, "interested": 2}
      , {"name": "Search",                                 "skilled": 4, "interested": 1}
      , {"name": "Networking",                             "skilled": 3, "interested": 4}
      , {"name": "Quality Assurance",                      "skilled": 2, "interested": 0}
      , {"name": "Performance Tuning",                     "skilled": 8, "interested":10}
      , {"name": "User Testing",                           "skilled": 8, "interested": 5}
      , {"name": "Security",                               "skilled": 1, "interested": 8}
      , {"name": "TDD",                                    "skilled":10, "interested": 1}
      , {"name": "PR",                                     "skilled": 0, "interested": 0}
      , {"name": "Functional Programming",                 "skilled": 5, "interested":13}
      , {"name": "Coaching/ Bootstrapping",                "skilled": 0, "interested": 3}
      , {"name": "Blogging",                               "skilled": 3, "interested": 3}
      , {"name": "SQL Databases",                          "skilled":15, "interested": 2}
      , {"name": "Ruby",                                   "skilled":17, "interested": 1}
      , {"name": "Brand Development",                      "skilled": 2, "interested": 3}
      , {"name": "Java",                                   "skilled": 6, "interested": 0}
      , {"name": "Field Research and User Empathy",        "skilled": 4, "interested": 1}
      , {"name": "Jumping",                                "skilled": 1, "interested": 0}
      , {"name": "Coffee",                                 "skilled":10, "interested": 4}
      , {"name": "Mentoring",                              "skilled":10, "interested": 5}
      , {"name": "Growth strategy",                        "skilled": 0, "interested": 8}
      , {"name": "Experiement-driven product development", "skilled": 1, "interested": 7}
      , {"name": "Social media marketing",                 "skilled": 0, "interested": 3}
      , {"name": "Product ideation / definition",          "skilled": 8, "interested": 6}
      , {"name": "Scala",                                  "skilled": 1, "interested": 3}
      , {"name": "Go",                                     "skilled": 3, "interested": 4}
      , {"name": "Haskell",                                "skilled": 3, "interested": 5}
      , {"name": "Data Strategy &amp; Analytics",          "skilled": 2, "interested": 5}
      , {"name": "Product Management",                     "skilled": 3, "interested": 5}
      , {"name": "Business strategy",                      "skilled": 3, "interested": 9}
      , {"name": "React",                                  "skilled": 6, "interested": 8}
      , {"name": "Customer Development",                   "skilled": 6, "interested": 4}
      , {"name": "Project Kick off",                       "skilled": 6, "interested": 4}
      , {"name": "Recruitment",                            "skilled": 4, "interested": 3}
      , {"name": "Stakeholder management",                 "skilled": 5, "interested": 2}
      , {"name": "Content strategy",                       "skilled": 0, "interested": 2}
      , {"name": "Individual Coaching",                    "skilled": 3, "interested": 0}
      , {"name": "Facilitation",                           "skilled": 7, "interested": 2}
      , {"name": "Swift",                                  "skilled": 4, "interested": 9}
      , {"name": "Team leadership",                        "skilled": 8, "interested": 5}
      , {"name": "Modeling",                               "skilled": 5, "interested": 2}
      ]
    </script>
  </head>
  <body>
    <div id="bubbles"></div>
    <script>
      var Bubbles = (function() {
        var margin = {top: 40, right: 40, bottom: 30, left: 40}
          , width  = 960
          , height = 800

        var svg;
        var force;

        function create(el, data) {
          width  = width - margin.left - margin.right
          height = height - margin.top - margin.bottom

          svg = d3.select(el).append('svg')
              .attr('class', 'd3')
              .attr('width', width + margin.right + margin.left)
              .attr('height', height + margin.top + margin.bottom)
            .append('g')
              .attr('transform', 'translate(' + margin.left + ',' + margin.top + ')')

          force = d3.layout.force()
            .charge(-100)
            .linkDistance(20)
            .size([width, height])

          update( data )
        }

        function update(data) {
          var cleanData = _munge(data)
          var scales = _scales(cleanData)

          force
            .nodes(cleanData)
            .start()

          var node = svg.selectAll('.node')
              .data(cleanData)
            .enter().append('circle')
              .attr('r', function(d) { return scales.r(d.combo) })
              .attr('fill', function(d) { return scales.color(d.diff) })
              .attr('class', 'node')
              .attr('cx', function(d) { return scales.x(d.skilled) })
              .attr('cy', function(d) { return scales.y(d.interested) })
              .call(force.drag)

          node.append('title')
            .text(function(d) { return d.name })

          var text = svg.selectAll('.label')
              .data(cleanData)
            .enter().append('text')
              .attr('class', 'label')
              .text(function(d) { return d.name })
              .attr('text-anchor', 'middle')
              .attr('font-family', 'sans-serif')
              .attr('font-size', '10px')
              .attr('fill', '#000')
              .attr('x', function(d) { return scales.x(d.skilled) })
              .attr('y', function(d) { return scales.y(d.interested) })

          var counts = svg.selectAll('.count')
              .data(cleanData)
            .enter().append('text')
              .attr('class', 'count')
              .text(function(d) { return d.skilled + ' - ' + d.interested })
              .attr('text-anchor', 'middle')
              .attr('dy', 10)
              .attr('font-family', 'sans-serif')
              .attr('font-size', '10px')
              .attr('fill', '#000')
              .attr('x', function(d) { return scales.x(d.skilled) })
              .attr('y', function(d) { return scales.y(d.interested) })

          // force.on('tick', function() {
          //   node.attr('cx', function(d) { return d.x; })
          //       .attr('cy', function(d) { return d.y; })
          //
          //   text.attr('x', function(d) { return d.x })
          //       .attr('y', function(d) { return d.y })
          //
          //   counts.attr('x', function(d) { return d.x })
          //         .attr('y', function(d) { return d.y })
          // })
        }

        function _munge(data) {
          data.forEach(function(item) {
            item.diff = item.interested - item.skilled
            item.combo = item.interested + item.skilled
          })

          return data;
        }

        function _scales(data) {
          var x = d3.scale.linear()
            .domain(d3.extent(data, function(d) { return d.skilled } ))
            .range([0, width])

          var y = d3.scale.linear()
            .domain(d3.extent(data, function(d) { return d.interested } ))
            .range([height, 0])

          var r = d3.scale.linear()
            .domain(d3.extent(data, function(d) { return d.combo } ))
            .range([4, 40])

          var color = d3.scale.quantize()
            .domain(d3.extent(data, function(d) { return d.diff } ))
            .range(colorbrewer.RdBu[9])
            // .range(colorbrewer.Spectral[9])
            // .range(colorbrewer.RdYlBu[9])

          return {
            x: x,
            y: y,
            r: r,
            color: color
          }
        }

        return {
          create: create,
          update: update
        }
      })();

      Bubbles.create('#bubbles', NEW_SKILLS)
    </script>
  </body>
</html>
